;
var addrTree = 
	[{
	"pn" : "B 北京市",
	"c" : [ {
			"cn" : "北京市",
			"h" : "1",
			"q" : [ {"qn" : "东城区","h" : "1"},
					{"qn" : "西城区","h" : "1"}, 
					{"qn" : "崇文区","h" : "1"}, 
					{"qn" : "宣武区","h" : "1"}, 
					{"qn" : "朝阳区","h" : "1"},
					{"qn" : "丰台区","h" : "1"},
					{"qn" : "石景山区","h" : "1"},
					{"qn" : "海淀区","h" : "1"},
					{"qn" : "门头沟区","h" : "1"},
					{"qn" : "房山区","h" : "1"}, 
					{"qn" : "通州区","h" : "1"}, 
					{"qn" : "顺义区","h" : "1"},
					{"qn" : "昌平区","h" : "1"}, 
					{"qn" : "大兴区","h" : "1"}, 
					{"qn" : "怀柔区","h" : "1"},
					{"qn" : "平谷区","h" : "1"},
					{"qn" : "密云县","h" : "1"} ]
			} ]
	},

	{
	"pn" : "J 江苏省",
	"c" : [ {
			"cn" : "南京市",
			"h" : "1",
			"q" : [ {"qn" : "玄武区","h" : "1"},
					{"qn" : "白下区","h" : "1"},
					{"qn" : "秦淮区","h" : "1"},
					{"qn" : "鼓楼区","h" : "1"},
					{"qn" : "建邺区","h" : "1"},
					{"qn" : "雨花台区","h" : "1"},
					{"qn" : "下关区","h" : "1"},
					{"qn" : "浦口区","h" : "1"},
					{"qn" : "六合区","h" : "1"},
					{"qn" : "栖霞区","h" : "1"},
					{"qn" : "江宁区","h" : "1"},
					{"qn" : "溧水区","h" : "1"},
					{"qn" : "高淳区","h" : "1"}]
			}, 
			{
			"cn" : "苏州市",
			"h" : "1",
			"q" :  [ {"qn" : "沧浪区","h" : "1"},
					 {"qn" : "平江区","h" : "1"},
					 {"qn" : "金阊区","h" : "1"},
					 {"qn" : "虎丘区","h" : "1"},
					 {"qn" : "吴中区","h" : "1"}, 
					 {"qn" : "相城区","h" : "1"},
					 {"qn" : "园区","h" : "1"}, 
					 {"qn" : "新区","h" : "1"},
					 {"qn" : "常熟市","h" : "1"}, 
					 {"qn" : "张家港市","h" : "1"}, 
					 {"qn" : "昆山市","h" : "1"},
					 {"qn" : "吴江市","h" : "1"},
					 {"qn" : "太仓市","h" : "1"} ]
			}, 
			{
			"cn" : "无锡市",
			"h" : "1",
			"q" : [ {"qn" : "崇安区","h" : "1"},
					{"qn" : "南长区","h" : "1"}, 
					{"qn" : "北塘区","h" : "1"}, 
					{"qn" : "锡山区","h" : "1"}, 
					{"qn" : "惠山区","h" : "1"},
					{"qn" : "滨湖区","h" : "1"}, 
					{"qn" : "新区","h" : "1"},
					{"qn" : "江阴市","h" : "1"},
					{"qn" : "宜兴市","h" : "1"} ]
		}]
	},

	{
	"pn" : "G 广东省",
	"c" : [ {
			"cn" : "广州市",
			"h" : "1",
			"q" :  [ {"qn" : "荔湾区","h" : "1"}, 
					 {"qn" : "越秀区","h" : "1"},
					 {"qn" : "海珠区","h" : "1"}, 
					 {"qn" : "天河区","h" : "1"}, 
					 {"qn" : "白云区","h" : "1"},
					 {"qn" : "黄埔区","h" : "1"}, 
					 {"qn" : "番禺区","h" : "1"}, 
					 {"qn" : "花都区","h" : "1"}, 
					 {"qn" : "南沙区","h" : "1"}, 
					 {"qn" : "萝岗区","h" : "1"}, 
					 {"qn" : "增城市","h" : "1"},
					 {"qn" : "从化市","h" : "1"} ]

		},  
		{
			"cn" : "深圳市",
			"h" : "1",
			"q" : [ {"qn" : "罗湖区","h" : "1"},
					{"qn" : "福田区","h" : "1"}, 
					{"qn" : "南山区","h" : "1"},
					{"qn" : "宝安区","h" : "1"},
					{"qn" : "龙岗区","h" : "1"}, 
					{"qn" : "盐田区","h" : "1"} ]
		}]
	},

	{
	"pn" : "S 上海市",
	"c" : [ {
			"cn" : "上海市",
			"h" : "1",
			"q" : [ {"qn" : "黄浦区","h" : "1"}, 
					{"qn" : "卢湾区","h" : "1"},
					{"qn" : "徐汇区","h" : "1"}, 
					{"qn" : "长宁区","h" : "1"},
					{"qn" : "静安区","h" : "1"}, 
					{"qn" : "普陀区","h" : "1"},
					{"qn" : "闸北区","h" : "1"},
					{"qn" : "虹口区","h" : "1"},
					{"qn" : "杨浦区","h" : "1"}, 
					{"qn" : "闵行区","h" : "1"}, 
					{"qn" : "宝山区","h" : "1"},
					{"qn" : "嘉定区","h" : "1"}, 
					{"qn" : "浦东内环","h" : "1"}, 
					{"qn" : "浦东中环","h" : "1"},
					{"qn" : "浦东外环","h" : "1"},
					{"qn" : "金山区","h" : "1"}, 
					{"qn" : "松江区","h" : "1"},
					{"qn" : "青浦区","h" : "1"},
					{"qn" : "南汇区","h" : "1"},
					{"qn" : "奉贤区","h" : "1"},
					{"qn" : "崇明县","h" : "1"} ]
		} ]
	},

	{
	"pn" : "Z 浙江省",
	"c" : [ {
			"cn" : "杭州市",
			"h" : "1",
			"q" :  [ {"qn" : "上城区","h" : "1"}, 
					 {"qn" : "下城区","h" : "1"}, 
					 {"qn" : "江干区","h" : "1"}, 
					 {"qn" : "拱墅区","h" : "1"}, 
					 {"qn" : "西湖区","h" : "1"}, 
					 {"qn" : "滨江区","h" : "1"}, 
					 {"qn" : "萧山区","h" : "1"}, 
					 {"qn" : "余杭区","h" : "1"}, 
					 {"qn" : "桐庐县","h" : "1"},
					 {"qn" : "淳安县","h" : "1"}, 
					 {"qn" : "建德市","h" : "1"},
					 {"qn" : "富阳市","h" : "1"}, 
					 {"qn" : "临安市","h" : "1"} ]
			}, 
			{
			"cn" : "宁波市",
			"h" : "1",
			"q" : [ {"qn" : "海曙区","h" : "1"},
					{"qn" : "江东区","h" : "1"}, 
					{"qn" : "江北区","h" : "1"},
					{"qn" : "北仑区","h" : "1"},
					{"qn" : "镇海区","h" : "1"},
					{"qn" : "鄞州区","h" : "1"},
					{"qn" : "象山县","h" : "1"},
					{"qn" : "宁海县","h" : "1"},
					{"qn" : "余姚市","h" : "1"}, 
					{"qn" : "慈溪市","h" : "1"}, 
					{"qn" : "奉化市","h" : "1"} ]
			}, 
			{
			"cn" : "温州市",
			"h" : "1",
			"q" : [ {"qn" : "鹿城区","h" : "1"},
				    {"qn" : "龙湾区","h" : "1"},
					{"qn" : "瓯海区","h" : "1"},
					{"qn" : "洞头县","h" : "1"}, 
					{"qn" : "永嘉县","h" : "1"}, 
					{"qn" : "平阳县","h" : "1"}, 
					{"qn" : "苍南县","h" : "1"}, 
					{"qn" : "文成县","h" : "1"},
					{"qn" : "泰顺县","h" : "1"},
					{"qn" : "瑞安市","h" : "1"}, 
					{"qn" : "乐清市","h" : "1"} ]
			}]
		}];

(function() {
	var temp_transact = $("#temp_transact");
	if (null == temp_transact || undefined == temp_transact){
		return;
	}
	var noServDiv = $("#noServDiv"), 
		ProvSel = $("#Prov"), 
		CitySel = $("#City"), 
		DistSel = $("#Dist"), 
		frimAddr = $("#frimAddr"),
		pi = 0, ci = 0, qi = 0, 
		lastarr = ["", "", "" ];
	
	if (undefined != frimAddr && null != frimAddr && "" != frimAddr.val()) {
		lastarr = frimAddr.val().split('|');
	}
	
	ProvSel.empty().prepend("<option value=''>请选择省/直辖市</option>");
	CitySel.empty().prepend("<option value=''>请选择市</option>");
	DistSel.empty().prepend("<option value=''>请选择区/县</option>");
	temp_transact.val("");
	
	for ( var i = 0, l = addrTree.length; i < l; i++) {
		if (addrTree[i].pn == lastarr[0]){
			pi = ProvSel.children("option").length;
		}
		ProvSel.append("<option value='"+addrTree[i].pn+"'>"+addrTree[i].pn+"</option>"); 
	}
	
	//选择省
	ProvSel.change( function() {
		
		ProvSel.css({"color":"#38528B"});
		CitySel.css({"color":"#999"});
		DistSel.css({"color":"#999"});
		noServDiv.css({"display":"none"});
		
		temp_transact.val("");
		CitySel.empty().prepend("<option value=''>请选择市</option>");
		DistSel.empty().prepend("<option value=''>请选择区/县</option>");
		
		var ProvSelindex = ProvSel.get(0).selectedIndex - 1;
		if (-1 != ProvSelindex) {
			var citysplit = addrTree[ProvSelindex];
			for ( var j = 0, l = citysplit.c.length; j < l; j++) {
				if (citysplit.c[j].cn == lastarr[1]){
					ci = CitySel.children("option").length;
				}
				CitySel.append("<option value='"+citysplit.c[j].cn+"'>"+citysplit.c[j].cn+"</option>"); 
			}
		} else {
			ProvSel.css({"color":"#999"});
		}
		if (CitySel.children("option").length == 2) {
			CitySel.get(0).selectedIndex = 1;
			CitySel.change();
		}
	});
	
	//选择市
	CitySel.change( function() {
		
		CitySel.css({"color":"#38528B"});
		DistSel.css({"color":"#999"});
		noServDiv.css({"display":"none"});
		
		DistSel.empty().prepend("<option value=''>请选择区/县</option>");
		temp_transact.val("");
		
		var CitySelindex = CitySel.get(0).selectedIndex - 1, 
			proindex = ProvSel.get(0).selectedIndex - 1;
		
		if (-1 != CitySelindex) {
			var qusplit = addrTree[proindex].c[CitySelindex];
			if (0 == qusplit.q.length) {
				DistSel.empty();
				var hkb = qusplit.h;
				temp_transact.val(hkb);
				noServDiv.css({"display":("0" == hkb ? "-webkit-box" : "none")});
				"0" == hkb ? Disabledbtn() : Enabledbtn();
			} else {
				for ( var k = 0; k < qusplit.q.length; k++) {
					if (qusplit.q[k].qn == lastarr[2]){
						qi = DistSel.children("option").length;
					}
					DistSel.append("<option value='"+qusplit.q[k].qn+"'>"+qusplit.q[k].qn+"</option>"); 
				}
			}
		} else {
			CitySel.css({"color":"#999"});
		}
		if (DistSel.children("option").length == 2) {
			DistSel.get(0).selectedIndex = 1;
			CitySel.css({"color":"#38528B"});
			DistSel.change();
		}

	});
	
	//选择区/县
	DistSel.change( function() {
		var proindex = ProvSel.get(0).selectedIndex - 1, 
			CitySelindex = CitySel.get(0).selectedIndex - 1, 
			quindex = DistSel.get(0).selectedIndex - 1;
		
		temp_transact.val("");
		CitySel.css({"color":"#38528B"});
		
		if (quindex != -1) {
			var citysplit = addrTree[proindex].c[CitySelindex];
			var citykabu = citysplit.h;
			var hkb = ("1" == citykabu ? citykabu : citysplit.q[quindex].h);
			temp_transact.val(hkb);
			
			noServDiv.css({"display":("0" == hkb ? "-webkit-box" : "none")});
			"0" == hkb ? Disabledbtn() : Enabledbtn();
		} else {
			noServDiv.css({"display":"none"});
			DistSel.css({"color":"#999"});
		}
	});
	
	if (pi != 0) {
		ProvSel.get(0).selectedIndex = pi;
		ProvSel.change();
		window.setTimeout(function() {
			CitySel.get(0).selectedIndex = ci;
			CitySel.change();
			window.setTimeout(function() {
				if ("" != lastarr[2]) {
					DistSel.get(0).selectedIndex = qi;
					DistSel.change();
				}
			}, 100);
		}, 100);
	}
	
})();